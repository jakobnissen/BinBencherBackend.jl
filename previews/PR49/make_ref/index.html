<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Making a reference · BinBencher.jl</title><meta name="title" content="Making a reference · BinBencher.jl"/><meta property="og:title" content="Making a reference · BinBencher.jl"/><meta property="twitter:title" content="Making a reference · BinBencher.jl"/><meta name="description" content="Documentation for BinBencher.jl."/><meta property="og:description" content="Documentation for BinBencher.jl."/><meta property="twitter:description" content="Documentation for BinBencher.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">BinBencher.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../nomenclariture/">Nomenclariture</a></li><li><a class="tocitem" href="../input_files/">Input files</a></li><li><span class="tocitem">CLI interface</span><ul><li><a class="tocitem" href="../cli_overview/">Overview</a></li><li><a class="tocitem" href="../benchmarking/">Benchmarking</a></li><li class="is-active"><a class="tocitem" href>Making a reference</a><ul class="internal"><li><a class="tocitem" href="#Genomes"><span>Genomes</span></a></li><li><a class="tocitem" href="#seqs"><span>Sequences</span></a></li><li><a class="tocitem" href="#Taxonomy"><span>Taxonomy</span></a></li><li><a class="tocitem" href="#Using-intermediate-JSON-files"><span>Using intermediate JSON files</span></a></li></ul></li></ul></li><li><span class="tocitem">Backend package</span><ul><li><a class="tocitem" href="../backend_overview/">Overview</a></li><li><a class="tocitem" href="../walkthrough/">Walkthrough</a></li><li><a class="tocitem" href="../reference/">API Reference</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">CLI interface</a></li><li class="is-active"><a href>Making a reference</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Making a reference</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/jakobnissen/BinBencherBackend.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/jakobnissen/BinBencherBackend.jl/blob/master/docs/src/make_ref.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="references"><a class="docs-heading-anchor" href="#references">Creating a reference</a><a id="references-1"></a><a class="docs-heading-anchor-permalink" href="#references" title="Permalink"></a></h1><p>For more information on the reference, see <a href="../input_files/#refjson">the description of the JSON file format</a>. For a definition of the concepts like <em>source</em> or <em>genome</em>, see <a href="../nomenclariture/#nomenclariture">the section on nomenclariture</a>.</p><p>At a high level, the reference contains:</p><ul><li>A list of the underlying genomes that are included in the simulation / the mock community.</li><li>A tree that gives the phylogenetic relationship between these genomes</li><li>A list of sequences included in the binning, and to which positions in the genomes they map to (are simulated from).</li></ul><p>In situations where the sequences have been simulated, you have perfect access to this information. However, there may be situations where this knowledge is only approximate - for example, if you simulate reads from the genomes and then assemble the reads, it might not be possible to know with 100% certainty where each contig ultimately is sourced from.</p><p>Although you can manually create the reference JSON file, I recommend using the <code>binbench makeref</code> command. It takes a number of input files to extract all the information, which I will go through here:</p><h2 id="Genomes"><a class="docs-heading-anchor" href="#Genomes">Genomes</a><a id="Genomes-1"></a><a class="docs-heading-anchor-permalink" href="#Genomes" title="Permalink"></a></h2><p>Each genome must be stored in a single fasta file, and the genome takes its name from the FASTA file (stripping the file extension). The entries in this fasta file are the sources. These fasta files are stored in some directory. To set the flags of the genome, have one directory with fasta files per set of flags.</p><h4 id="Example"><a class="docs-heading-anchor" href="#Example">Example</a><a id="Example-1"></a><a class="docs-heading-anchor-permalink" href="#Example" title="Permalink"></a></h4><p>Given the following directory structure</p><pre><code class="nohighlight hljs">.
├── collection_a
│   ├── genome1.fna
│   └── genome2.fna
└── collection_b
    └── genome3.fna</code></pre><p>And where the content of e.g. <code>genome1.fna</code> is:</p><pre><code class="nohighlight hljs">&gt;seq1
TAGA
&gt;seq2
TAA
GA</code></pre><p>You can pass <code>--genome-directories plasmid+virus=collection_a,organism=collection_b</code>. Thus, the genomes <code>genome1</code> and <code>genome2</code> will be have the flags <code>virus</code> and <code>plasmid</code>, and <code>genome3</code> will have the flag <code>organism</code>. The genome <code>genome1</code> will have two sources <code>seq1</code> with length 4 and <code>seq2</code> with length 5.</p><h2 id="seqs"><a class="docs-heading-anchor" href="#seqs">Sequences</a><a id="seqs-1"></a><a class="docs-heading-anchor-permalink" href="#seqs" title="Permalink"></a></h2><p>The sequence (contig) names and lengths are obtained from reading a FASTA file with the sequences.</p><p>The mapping position(s), if any, of each sequence is given by a 4-column TSV file with the sequence name, the source name, mapping start and mapping end (1-based, inclusive).</p><h4 id="Example-2"><a class="docs-heading-anchor" href="#Example-2">Example</a><a class="docs-heading-anchor-permalink" href="#Example-2" title="Permalink"></a></h4><p>Given sequences <code>seq1</code>, <code>seq2</code> and <code>seq3</code>, and the following mapping file</p><pre><code class="nohighlight hljs">sequence	source	start	end
seq1	src1	4	9
seq1	src1	11	15
seq1	src2	1	6
seq3	src3	15	7</code></pre><ul><li><code>seq1</code> maps to three locations, two of which are in the same source. Note that the length of the spans (mapping end to start) need not be the same</li><li><code>seq2</code> is not present - it maps to nothing (or its mapping is unknown)</li><li><code>seq3</code> maps exclusively to <code>src3</code>. Note that its mapping start is greater than its mapping end. This indicates that <code>src3</code> is circular, and <code>seq3</code> maps across the breakpoint (origin) of the sequence</li></ul><p>Mapping locations use 1-based indexing and are inclusive.</p><h2 id="Taxonomy"><a class="docs-heading-anchor" href="#Taxonomy">Taxonomy</a><a id="Taxonomy-1"></a><a class="docs-heading-anchor-permalink" href="#Taxonomy" title="Permalink"></a></h2><p>The taxonomy is specified with a 3-column TSV file with the header <code>rank\tchild\tparent</code>. The first column gives the rank, which may be one of: &#39;strain&#39;, &#39;species&#39;, &#39;genus&#39;, &#39;family&#39;, &#39;order&#39;, &#39;class&#39;, &#39;phylum&#39;, and gives the rank of the child. The second column gives the name of the child, which is either a genome name (if the rank is <code>strain</code>), or else a parent specified in this file. The last column gives the name of the parent.</p><h4 id="Example-3"><a class="docs-heading-anchor" href="#Example-3">Example</a><a class="docs-heading-anchor-permalink" href="#Example-3" title="Permalink"></a></h4><pre><code class="nohighlight hljs">rank	child	parent
strain	genome1	Bacillus subtilis
strain	genome2	Bacillus subtilis
strain	genome3	Clostridium tetani
species	Bacillus subtilis	Bacillus
species	Clostridium tetani	Clostridium
genus	Bacillus	Bacillaceae
genus	Clostridium	Clostridiaceae
family	Bacillaceae	Bacillales
family	Clostridiaceae	Eubacteriales
order	Bacillales	Bacilli
order	Eubacteriales	Clostridia
class	Bacilli		Bacillota
class	Clostridia	Bacillota</code></pre><p>This specifies the full lineage of all three genomes up to a single universal ancestor of all the genomes (Bacillota, in this case).</p><h4 id="Using-NCBI-for-easier-taxonomy"><a class="docs-heading-anchor" href="#Using-NCBI-for-easier-taxonomy">Using NCBI for easier taxonomy</a><a id="Using-NCBI-for-easier-taxonomy-1"></a><a class="docs-heading-anchor-permalink" href="#Using-NCBI-for-easier-taxonomy" title="Permalink"></a></h4><p>It may be annoying to specify the full phylogenetic tree of all clades in the taxonomy file. To ease it, the parent may instead be listed as <code>id=XXXX</code>, where <code>XXXX</code> is an NCBI taxonomy ID on the parent rank. BinBencher will then fill up all higher ranks automatically. To enable this, <code>--tax-ncbi</code> must be passed on the command line to a file that contains a list of all known NCBI taxonomies. A link to this file can be found at the BinBencher github repo. So, the taxonomy file above can more easily be written as:</p><pre><code class="nohighlight hljs">rank	child	parent
strain	genome1	id=1423
strain	genome2	id=1423
strain	genome3	id=1513</code></pre><p>You do not need to specify the NCBI tax id for all entries, but can specify them for a subset of entries if necessary.</p><h2 id="Using-intermediate-JSON-files"><a class="docs-heading-anchor" href="#Using-intermediate-JSON-files">Using intermediate JSON files</a><a id="Using-intermediate-JSON-files-1"></a><a class="docs-heading-anchor-permalink" href="#Using-intermediate-JSON-files" title="Permalink"></a></h2><p>The genomes, the sequences and the taxonomy are each parsed from their input files, and saved as intermediate JSON files.</p><p>For example, after <a href="#seqs">parsing in information about the sequences</a>, BinBencher will create a <code>seqs.json</code> file. For subsequent runs, instead of passing the sequences fasta file and the mapping locations with <code>--seq-fasta</code> and <code>--seq-mapping</code>, you can pass the JSON file with <code>--seq-json</code>.</p><p>You can also manually create these intermediate output JSON files, such that you don&#39;t need to supply the corresponding input files. Suppose you want to create a reference, but that your genomes have such complex sets of flags that it is impractical to pass <code>--genome-directories</code>. You can then manually create the genomes intermediate JSON file and pass <code>--genome-json</code> instead of <code>--genome-directories</code>.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../benchmarking/">« Benchmarking</a><a class="docs-footer-nextpage" href="../backend_overview/">Overview »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.8.0 on <span class="colophon-date" title="Friday 22 November 2024 12:22">Friday 22 November 2024</span>. Using Julia version 1.11.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
